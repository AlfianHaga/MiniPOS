{% extends 'base.html' %}
{% load humanize %}
{% load currency_filters %}
{% block title %}Order #{{ order.id }}{% endblock %}
{% block page_title %}
  {% with t='Order #'|add:order.id %}
    {% include 'pos/_hero.html' with title=t subtitle=order.customer.name icon='bi bi-receipt' %}
  {% endwith %}
{% endblock %}
{% block content %}
<div class="card p-3">
  <div class="mb-3">
    <div><strong>Pelanggan:</strong> {{ order.customer.name }}</div>
    <div><strong>Tanggal:</strong> {{ order.created_at|date:"j M Y, H:i" }}</div>
  </div>
  <div class="table-responsive">
  <table class="table table-hover align-middle mb-0">
    <thead>
      <tr>
        <th>Produk</th>
        <th class="text-end">Jumlah</th>
        <th class="text-end">Harga Satuan</th>
        <th class="text-end">Diskon</th>
        <th class="text-end">Subtotal</th>
      </tr>
    </thead>
    <tbody>
      {% for it in order.items.all %}
      <tr>
        <td>{{ it.product.name }}</td>
        <td class="text-end">{{ it.quantity }}</td>
        <td class="text-end">{{ it.price|idr }}</td>
        <td class="text-end">{% if it.discount_percent > 0 %}{{ it.discount_percent }}% <span class="text-muted">({{ it.discount_amount|idr }})</span>{% else %}-{% endif %}</td>
        <td class="text-end">{{ it.subtotal|idr }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  </div>
  <div class="mt-3 d-flex justify-content-between align-items-center">
    <h5 class="mb-0">Total: Rp {{ order.total_price|floatformat:0|intcomma }}</h5>
    <div>
      <a href="{% url 'order_receipt' order.id %}" class="btn btn-primary" target="_blank">
        <i class="bi bi-printer"></i> Cetak Struk
      </a>
      <a href="{% url 'order_receipt' order.id %}" class="btn btn-outline-primary" download>
        <i class="bi bi-download"></i> Download PDF
      </a>
    </div>
  </div>
</div>
{% endblock %}
